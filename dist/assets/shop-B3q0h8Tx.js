var w=Object.defineProperty;var v=(u,t,s)=>t in u?w(u,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[t]=s;var _=(u,t,s)=>v(u,typeof t!="symbol"?t+"":t,s);import{_ as A,a as E,b as C,c as k,d as S,e as j,f as O,g as N,h as F,i as R,j as I}from"./zeus-C7msOkHA.js";import{a as W,f as B,b as z,p as U}from"./index-CJe7qmAn.js";class ${constructor(){_(this,"root");_(this,"list");_(this,"coinsEl");_(this,"uid",null);this.root=document.createElement("div"),Object.assign(this.root.style,{position:"fixed",inset:"0",zIndex:"130",display:"grid",gridTemplateRows:"auto 1fr",background:"rgba(0,0,0,0.15)"});const t=document.createElement("div");Object.assign(t.style,{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"10px",padding:"12px 16px",margin:"14px auto 8px",width:"min(980px,94vw)",borderRadius:"14px",background:"rgba(8,10,28,0.72)",color:"#fff",backdropFilter:"blur(10px)",boxShadow:"0 12px 28px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,0.06)"});const s=document.createElement("button");s.textContent="← Zurück",Object.assign(s.style,{padding:"10px 12px",border:"0",borderRadius:"10px",cursor:"pointer",fontWeight:"900",background:"rgba(255,255,255,0.14)",color:"#fff"}),s.onclick=()=>this.close();const r=document.createElement("div");r.textContent="Shop",Object.assign(r.style,{fontWeight:"900",fontSize:"20px"});const b=document.createElement("div");Object.assign(b.style,{display:"flex",alignItems:"center",gap:"8px",fontWeight:"900"});const m=(()=>{const c="http://www.w3.org/2000/svg",e=document.createElementNS(c,"svg");e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("width","18"),e.setAttribute("height","18");const d=document.createElementNS(c,"circle");d.setAttribute("cx","12"),d.setAttribute("cy","12"),d.setAttribute("r","9"),d.setAttribute("fill","#ffd54a");const n=document.createElementNS(c,"circle");n.setAttribute("cx","12"),n.setAttribute("cy","12"),n.setAttribute("r","7"),n.setAttribute("fill","#ffe17a");const i=document.createElementNS(c,"rect");return i.setAttribute("x","8"),i.setAttribute("y","11"),i.setAttribute("width","8"),i.setAttribute("height","2"),i.setAttribute("rx","1"),i.setAttribute("fill","#b88b09"),e.append(d,n,i),e})(),g=document.createElement("span");g.textContent="0",this.coinsEl=g,b.append(m,g),t.append(s,r,b);const l=document.createElement("div");Object.assign(l.style,{margin:"0 auto 18px",padding:"16px",width:"min(980px,94vw)",borderRadius:"16px",background:"rgba(8,10,28,0.72)",color:"#fff",backdropFilter:"blur(10px)",boxShadow:"0 24px 48px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,0.06)"});const o=document.createElement("div");this.list=o,Object.assign(o.style,{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"14px"}),l.appendChild(o),this.root.append(t,l),document.body.appendChild(this.root),this.load()}async load(){const t=W.currentUser;if(this.uid=(t==null?void 0:t.uid)||null,this.uid){const[s,r]=await Promise.all([B(this.uid),z(this.uid)]);this.setCoins(s);try{window.dispatchEvent(new CustomEvent("coins-updated",{detail:s}))}catch{}await this.populate(r||{})}else this.setCoins(0),await this.populate({})}setCoins(t){this.coinsEl.textContent=String(Math.max(0,Math.floor(t)))}priceFor(t){const s=t.split(".")[0];return/^\d+$/.test(s)?1e3:5e3}async populate(t){this.list.replaceChildren();let s=[];try{s=Object.values(Object.assign({"../premium/1.png":I,"../premium/3.png":R,"../premium/4.png":F,"../premium/5.png":N,"../premium/dergott.png":O,"../premium/enkhi.png":j,"../premium/gaia.png":S,"../premium/galaxy.png":k,"../premium/goettin.png":C,"../premium/mihi.png":E,"../premium/zeus.png":A}))}catch{}for(const r of s){const b=r.split("/").pop()||"",m=b.split(".")[0],g=this.priceFor(b),l=document.createElement("div");Object.assign(l.style,{padding:"12px",borderRadius:"12px",background:"rgba(255,255,255,0.06)",boxShadow:"inset 0 0 0 1px rgba(255,255,255,0.08)"});const o=new Image;o.src=r,o.style.width="100%",o.style.height="140px",o.style.objectFit="contain",o.style.display="block";const c=document.createElement("div");c.textContent=m,Object.assign(c.style,{fontWeight:"900",margin:"8px 0 6px"});const e=document.createElement("button"),d=!!t[m];Object.assign(e.style,{width:"100%",padding:"10px 12px",borderRadius:"10px",border:"0",cursor:"pointer",fontWeight:"900"});const n=i=>{if(e.replaceChildren(),i)e.textContent="Besitzt",e.style.background="#10b981",e.style.color="#052",e.disabled=!0;else{e.style.background="#fbbf24",e.style.color="#111",e.disabled=!1;const a="http://www.w3.org/2000/svg",h=document.createElementNS(a,"svg");h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("width","16"),h.setAttribute("height","16");const x=document.createElementNS(a,"circle");x.setAttribute("cx","12"),x.setAttribute("cy","12"),x.setAttribute("r","9"),x.setAttribute("fill","#ffd54a");const f=document.createElementNS(a,"circle");f.setAttribute("cx","12"),f.setAttribute("cy","12"),f.setAttribute("r","7"),f.setAttribute("fill","#ffe17a");const p=document.createElementNS(a,"rect");p.setAttribute("x","8"),p.setAttribute("y","11"),p.setAttribute("width","8"),p.setAttribute("height","2"),p.setAttribute("rx","1"),p.setAttribute("fill","#b88b09"),h.append(x,f,p);const y=document.createElement("span");y.textContent=`Kaufen (${g})`,y.style.marginRight="8px",e.append(y,h)}};n(d),e.onclick=async()=>{if(!this.uid){alert("Bitte mit Google anmelden.");return}e.disabled=!0;const i=await U(this.uid,m,g);if(i.ok){this.setCoins(i.coins);try{window.dispatchEvent(new CustomEvent("coins-updated",{detail:i.coins}))}catch{}n(!0)}else{i.reason==="already-owned"?n(!0):i.reason==="insufficient-coins"?(alert("Nicht genug Coins."),n(!1)):(alert("Fehler beim Kauf."),n(!1));const a=i==null?void 0:i.coins;if(typeof a=="number"&&Number.isFinite(a)){this.setCoins(a);try{window.dispatchEvent(new CustomEvent("coins-updated",{detail:a}))}catch{}}}},l.append(o,c,e),this.list.appendChild(l)}}show(){this.root.style.display="grid"}close(){this.root.remove()}}export{$ as ShopOverlay};
